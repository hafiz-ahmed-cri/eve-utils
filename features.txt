Ignore this file
- it is a rough memory jog list that will eventually become documentation


List of features to documentation
---------------------------------
settings system
- principles:
    - API should run right after git clone, i.e. with optionals omitted or with default values (even if only in limited capacity)
    - all settings can be set (or derived) from envars (container compatible)
    - _env.conf takes precedence (developer convenience)
- envars (useful for docker, serverless)
- defaults
- dumped to log
- viewable via endpoint
- extensible (add settings, add additional modules (e.g. auth) with its own settings)
- cancelable/optional (doco!)
- comes with...
  - built-in
    'ES_API_NAME': 'my-api',
    'ES_MONGO_HOST': os.environ.get('ES_MONGO_HOST', 'localhost'),
    'ES_MONGO_PORT': os.environ.get('ES_MONGO_PORT', 27017),
    'ES_MONGO_DBNAME': os.environ.get('ES_MONGO_DBNAME', 'my-api'),
    'ES_API_PORT': os.environ.get('ES_API_PORT', 2112),
    'ES_INSTANCE_NAME': os.environ.get('ES_INSTANCE_NAME', socket.gethostname()),
    'ES_TRACE_LOGGING': os.environ.get('ES_TRACE_LOGGING', 'Enabled'),
    'ES_PAGINATION_LIMIT': os.environ.get('ES_PAGINATION_LIMIT', 3000),
    'ES_PAGINATION_DEFAULT': os.environ.get('ES_PAGINATION_DEFAULT', 1000),
    'SMTP_HOST': os.environ.get('SMTP_HOST', 'internalmail.cri.com'),
    'SMTP_PORT': os.environ.get('SMTP_PORT', 25),
    'EMAIL_RECIPIENTS': os.environ.get('EMAIL_RECIPIENTS', 'michael@pointw.com'),
 
 - auth
    'ES_AUTH_ADD_BASIC': os.environ.get('ES_AUTH_ADD_BASIC', 'No'),  # [0] in 'yYtT', i.e. yes, Yes, true, True
    'ES_AUTH_ROOT_PASSWORD': os.environ.get('ES_AUTH_ROOT_PASSWORD', 'password'),
    'ES_AUTH_REALM': os.environ.get('ES_AUTH_REALM', 'my-api.cri.com'),

    'ES_AUTH_JWT_DOMAIN': os.environ.get('ES_AUTH_JWT_DOMAIN', 'my-api.us.auth0.com'),
        # Auth0: Applications->Applications->(Custom Application)->Basic Information->Domain
    'ES_AUTH_JWT_ISSUER': os.environ.get('ES_AUTH_JWT_ISSUER', 'https://my-api.us.auth0.com/'),
        # https://{ES_AUTH_JWT_DOMAIN}/
    'ES_AUTH_JWT_AUDIENCE': os.environ.get('ES_AUTH_JWT_AUDIENCE', 'https://cri.com/my-api'),
        # Auth0: Applications->APIs->API Audience (from the Custom API created for your api)

    'AUTH0_API_AUDIENCE': os.environ.get('AUTH0_API_AUDIENCE', 'https://my-api.us.auth0.com/api/v2/'),
        # https://{ES_AUTH_JWT_DOMAIN}/api/v2/
    'AUTH0_API_BASE_URL': os.environ.get('AUTH0_API_BASE_URL', 'https://my-api.us.auth0.com/api/v2'),
        # https://{ES_AUTH_JWT_DOMAIN}/api/v2   (note: is absence of trailing slash important between this and above?)
    'AUTH0_CLAIMS_NAMESPACE': os.environ.get('AUTH0_CLAIMS_NAMESPACE', 'https://cri.com/my-api'),
        # it's a good practice to use the same value as ES_AUTH_JWT_AUDIENCE
    'AUTH0_TOKEN_ENDPOINT': os.environ.get('AUTH0_TOKEN_ENDPOINT', 'https://my-api.us.auth0.com/oauth/token'),
        # https://{ES_AUTH_JWT_DOMAIN}/oauth/token  (
        # Auth0: Applications->Applications->Machine-to-machine->Advanced Settings->Endpoints->OAuth Token URL
    'AUTH0_CLIENT_ID': os.environ.get('AUTH0_CLIENT_ID', '--your-client-id--'),
        # Auth0: Applications->APIs->Auth0 Management API->Machine To Machine Applications (enable Authorized)
        # also found at Applications->Applications->(Machine to Machine)->Basic Information->Client ID
    'AUTH0_CLIENT_SECRET': os.environ.get('AUTH0_CLIENT_SECRET',
                                          '--your-client-secret--'),
        # Auth0: Applications->Applications->(Machine to Machine)->Basic Information->Client Secret


- ES_ADD_ECHO - turns on endpoint that echos the message body with given status_code                                          
 
    
- expandable for app needs
    - cancellable
    - is_enabled == 'YyTtEe'
_settings endpoint
    - GET from API call


logging
    - /var/log/*app-name*
    - dumps settings, incl. key version numbers
    - email on error
        - includes app name, version, and hostname
    - _logging endpoint 
        - GET and PUT verbosity via API call

exception handling 
    - emit JSON/500 on unhandled exception instead of HTML
    - make_error_response
    - standards {_status: "ERR", _error: {code:422, message: ""}, _issues: [] }

@trace decorator

commands
- mkapi (-d|--with_docker, -v|--with_val, -a|--with_auth, -s|--with_serverless -w|--with_web_socket)
- mkresource
- mkrel
- add_docker
    docker-compose: 
        volumes for logs and for mongo (db & config)
        .env (project_name)
- add_auth
    - out-of-box BASIC (ES_AUTH_ADD_BASIC = Yes - added to _env.conf) 
        grants all usernames no matter what password,
        admin if root (unless accounts is used, then account.role=='admin')
        used as backdoor - to harden modify es_auth.process_claims and auth_handlers.basic()
- add_val
    - adds custom validation class
    - two validation rules added
        - unique_ignorecase
        - unique_to_parent
    - three custom types
        - iso_date
        - iso_time
        - iso_duration
- add_serverless
    - basic wiring for aws, azure, google
    - also provides sls wsgi serve
- add_web_socket
    - wires up a web socket, listening at /_ws
    - provides samples (which should be deleted before production)

tidied _links (parent, collection, etc.)

configuration
    
organized folder structure
- domain decomposition
- hooks
- common.py

_x
name
description

make_error_response

_env_conf

field naming conventions
- xxx_ref is an expandable field
- starting with _ is a non-domain field (e.g. _id, _meta)
- enforced pluralization (resource names are collection names, therefore plural)


Default Eve settings
- CORS stuff (in eve_service.py and in settings.py)

utils
- make_error_response()
- get_db()

